:root{
  --bg1:#07121f;
  --bg2:#0b2238;
  --card:#0d1927cc;
  --line:#ffffff1a;
  --text:#eaf2ff;
  --muted:#b9c7de;
  --accent:#8ee8ff;
  --good:#7CFFB2;
  --warn:#ffd36b;
  --shadow: 0 16px 60px rgba(0,0,0,.45);
  --radius: 24px;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  color:var(--text);
  font: 16px/1.35 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background: radial-gradient(1200px 700px at 20% 10%, #123a62 0%, transparent 55%),
              radial-gradient(900px 600px at 80% 25%, #1b2a45 0%, transparent 60%),
              linear-gradient(180deg, var(--bg1), var(--bg2));
  overflow-x:hidden;
}

.bg{
  position:fixed; inset:0;
  pointer-events:none;
  background:
    radial-gradient(2px 2px at 10% 30%, #ffffffaa 50%, transparent 55%),
    radial-gradient(2px 2px at 35% 15%, #ffffff88 50%, transparent 55%),
    radial-gradient(1.5px 1.5px at 55% 40%, #ffffff88 50%, transparent 55%),
    radial-gradient(2px 2px at 70% 25%, #ffffff99 50%, transparent 55%),
    radial-gradient(1.5px 1.5px at 85% 45%, #ffffff77 50%, transparent 55%);
  opacity:.7;
  filter: blur(.2px);
  animation: twinkle 5s ease-in-out infinite alternate;
}

@keyframes twinkle{
  from{opacity:.55}
  to{opacity:.85}
}

.wrap{
  min-height:100%;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:22px 14px;
}

.card{
  width:min(520px, 96vw);
  background: linear-gradient(180deg, #0f2237cc, #071523cc);
  border:1px solid var(--line);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  backdrop-filter: blur(10px);
  overflow:hidden;
}

.top{
  padding:18px 18px 6px;
  display:flex;
  flex-direction:column;
  gap:12px;
}

.badge{
  display:inline-flex;
  align-items:center;
  gap:10px;
  padding:10px 12px;
  border-radius:999px;
  background:#ffffff10;
  border:1px solid #ffffff1a;
  width:fit-content;
  font-weight:700;
}

.bubble{
  position:relative;
  background: #f5f7fb;
  color:#0d1a2b;
  border-radius:18px;
  padding:14px 14px 16px;
  box-shadow: 0 12px 30px rgba(0,0,0,.25);
}
.bubble-title{
  font-weight:800;
  opacity:.85;
  margin-bottom:6px;
}
.bubble-text{
  font-size:22px;
  font-weight:900;
  letter-spacing:-.2px;
}
.bubble-tail{
  position:absolute;
  left:34px;
  bottom:-10px;
  width:22px; height:22px;
  background:#f5f7fb;
  transform: rotate(45deg);
  border-radius:6px;
  box-shadow: 6px 6px 14px rgba(0,0,0,.08);
}

.stage{
  padding: 6px 18px 14px;
}
.stage-frame{
  position:relative;
  height: 290px;
  border-radius: 22px;
  border:1px solid #ffffff1a;
  background: radial-gradient(500px 220px at 45% 20%, #163a65 0%, transparent 60%),
              linear-gradient(180deg, #071523, #06101c);
  overflow:hidden;
}
.sceneHost{
  width:100%;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
}

.bottom{
  border-top:1px solid var(--line);
  padding: 16px 18px 18px;
  background: linear-gradient(180deg, transparent, #0000001a);
}
.taskTitle{
  font-size:28px;
  font-weight:900;
  letter-spacing:-.5px;
}
.taskSub{
  margin-top:6px;
  color:var(--muted);
  font-weight:650;
}

.ctaRow{
  margin-top:14px;
  display:flex;
  gap:12px;
  align-items:center;
}
.cta{
  flex:1;
  padding:14px 14px;
  border-radius:16px;
  border:1px solid #ffffff20;
  background: linear-gradient(180deg, #ffffff14, #ffffff08);
  color:var(--text);
  font-weight:900;
  cursor:pointer;
  box-shadow: 0 10px 24px rgba(0,0,0,.25);
}
.cta:active{transform: translateY(1px) scale(.995)}
.counter{
  min-width:78px;
  text-align:center;
  padding:12px 10px;
  border-radius:14px;
  border:1px solid #ffffff1a;
  background:#ffffff0d;
  font-weight:900;
}

/* Snow overlay */
.snowOverlay{
  position:absolute; inset:0;
  display:flex;
  align-items:stretch;
  justify-content:stretch;
}
.snowOverlay.hidden{display:none}
#snowCanvas{
  position:absolute; inset:0;
  width:100%; height:100%;
  touch-action:none;
}
.snowHint{
  position:absolute;
  left:14px; right:14px; bottom:14px;
  padding:14px 14px;
  border-radius:18px;
  border:1px solid #ffffff1f;
  background: #071523cc;
  backdrop-filter: blur(10px);
  box-shadow: 0 16px 44px rgba(0,0,0,.35);
}
.snowHintTitle{font-weight:900; font-size:18px}
.snowHintSub{margin-top:4px; color:var(--muted); font-weight:700}
.progressRow{margin-top:10px; display:flex; gap:10px; align-items:center}
.progressBar{
  flex:1;
  height:12px;
  border-radius:999px;
  background:#ffffff14;
  border:1px solid #ffffff1a;
  overflow:hidden;
}
.progressFill{height:100%; width:0% ; background: linear-gradient(90deg, var(--accent), #ffffff); }
.progressText{min-width:46px; text-align:right; font-weight:900}

/* Finale overlay */
.finalOverlay{
  position:absolute; inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:16px;
  background: radial-gradient(520px 320px at 50% 30%, #ffffff1a 0%, transparent 65%),
              linear-gradient(180deg, #00000066, #00000088);
}
.finalOverlay.hidden{display:none}
.finalCard{
  width:min(420px, 92vw);
  background: linear-gradient(180deg, #0e2239, #071523);
  border:1px solid #ffffff1f;
  border-radius:24px;
  box-shadow: 0 20px 70px rgba(0,0,0,.55);
  padding:18px 18px 16px;
}
.finalTitle{font-size:22px; font-weight:1000; letter-spacing:-.3px}
.finalSub{margin-top:6px; color:var(--muted); font-weight:750}
.giftRow{margin-top:14px; display:flex; flex-direction:column; gap:10px}
.giftBtn{
  padding:14px 14px;
  border-radius:18px;
  border:1px solid #ffffff22;
  background: linear-gradient(180deg, #fff3 0%, #fff1 100%);
  color:var(--text);
  font-weight:1000;
  cursor:pointer;
}
.codeBox{
  padding:12px 12px;
  border-radius:16px;
  border:1px dashed #ffffff33;
  background:#ffffff0b;
  display:flex;
  justify-content:space-between;
  gap:12px;
  align-items:center;
  user-select:text;
}
.codeLabel{color:var(--muted); font-weight:800}
.codeValue{font-weight:1000; letter-spacing:1px}
.tinyNote{margin-top:10px; color:#ffffffaa; font-weight:650; font-size:12px}
.smallBtn{
  margin-top:12px;
  width:100%;
  padding:12px 12px;
  border-radius:16px;
  border:1px solid #ffffff1f;
  background:#ffffff0a;
  color:var(--text);
  font-weight:900;
  cursor:pointer;
}

/* Reduce motion */
@media (prefers-reduced-motion: reduce){
  .bg{animation:none}
}
